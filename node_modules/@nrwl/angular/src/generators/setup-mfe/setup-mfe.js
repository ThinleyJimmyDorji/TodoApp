"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.setupMfe = void 0;
const tslib_1 = require("tslib");
const devkit_1 = require("@nrwl/devkit");
const lib_1 = require("./lib");
function setupMfe(host, options) {
    return tslib_1.__awaiter(this, void 0, void 0, function* () {
        const projectConfig = devkit_1.readProjectConfiguration(host, options.appName);
        const remotesWithPorts = lib_1.getRemotesWithPorts(host, options);
        lib_1.addRemoteToHost(host, options);
        lib_1.generateWebpackConfig(host, options, projectConfig.root, remotesWithPorts);
        lib_1.addEntryModule(host, options, projectConfig.root);
        lib_1.addImplicitDeps(host, options);
        lib_1.changeBuildTarget(host, options);
        lib_1.setupServeTarget(host, options);
        lib_1.fixBootstrap(host, projectConfig.root);
        // add package to install
        const installPackages = devkit_1.addDependenciesToPackageJson(host, { '@angular-architects/module-federation': '^12.2.0' }, {});
        // format files
        if (!options.skipFormat) {
            yield devkit_1.formatFiles(host);
        }
        return installPackages;
    });
}
exports.setupMfe = setupMfe;
exports.default = setupMfe;
//# sourceMappingURL=setup-mfe.js.map