"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.normalizeNxJson = void 0;
/**
 * Normalize nx json by replacing wildcard `*` implicit dependencies
 * to an array of all project names
 * @param {NxJsonConfiguration} nxJson
 * @returns {NxJsonConfiguration<string[]>}
 */
function normalizeNxJson(nxJson) {
    return nxJson.implicitDependencies
        ? Object.assign(Object.assign({}, nxJson), { implicitDependencies: Object.entries(nxJson.implicitDependencies).reduce((acc, [key, val]) => {
                acc[key] = recur(nxJson, val);
                return acc;
            }, {}) }) : nxJson;
}
exports.normalizeNxJson = normalizeNxJson;
/**
 * Map recursively wildcard `*` to project names
 * @param {NxJsonConfiguration} nxJson
 * @param {'*' | string[] | {}} v
 * @returns {string[] | {}}
 */
function recur(nxJson, v) {
    if (v === '*') {
        return Object.keys(nxJson.projects);
    }
    else if (Array.isArray(v)) {
        return v;
    }
    else {
        return Object.keys(v).reduce((acc, key) => {
            acc[key] = recur(nxJson, v[key]);
            return acc;
        }, {});
    }
}
//# sourceMappingURL=normalize-nx-json.js.map